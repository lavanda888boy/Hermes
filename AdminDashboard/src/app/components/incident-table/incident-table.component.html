<div class="incident-table-container">
  <table mat-table [dataSource]="incidents">
    <ng-container matColumnDef="category">
      <th mat-header-cell *matHeaderCellDef>Category</th>
      <td mat-cell *matCellDef="let incident">{{ incident.category }}</td>
    </ng-container>

    <ng-container matColumnDef="severity">
      <th mat-header-cell *matHeaderCellDef style="text-align: center;">Severity</th>
      <td mat-cell *matCellDef="let incident" style="text-align: center;">{{ incident.severity |
        severity }}</td>
    </ng-container>

    <ng-container matColumnDef="areaRadius">
      <th mat-header-cell *matHeaderCellDef style="text-align: center;">Area radius (km)</th>
      <td mat-cell *matCellDef="let incident" style="text-align: center;">{{ incident.areaRadius }}</td>
    </ng-container>

    <ng-container matColumnDef="timestamp">
      <th mat-header-cell *matHeaderCellDef style="text-align: center;">Timestamp</th>
      <td mat-cell *matCellDef="let incident" style="text-align: center;">{{ incident.timestamp | date:'dd/MM/yyyy
        HH:mm' }}
      </td>
    </ng-container>

    <ng-container matColumnDef="coordinates">
      <th mat-header-cell *matHeaderCellDef>Coordinates</th>
      <td mat-cell *matCellDef="let incident">{{ incident | coordinates }}</td>
    </ng-container>

    <ng-container matColumnDef="userToReport">
      <th mat-header-cell *matHeaderCellDef>User device</th>
      <td mat-cell *matCellDef="let incident">{{ incident.userToReport }}</td>
    </ng-container>

    <ng-container matColumnDef="description">
      <th mat-header-cell *matHeaderCellDef>Description</th>
      <td mat-cell *matCellDef="let incident" style="width: 350px;">{{ incident.description }}</td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let incident" style="text-align: center;">
        <button mat-icon-button [matMenuTriggerFor]="menu" (click)="setSelectedIncident(incident)"
          aria-label="Incident actions">
          <mat-icon>more_vert</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="getDisplayedColumns()"></tr>
    <tr mat-row *matRowDef="let row; columns: getDisplayedColumns();"></tr>
  </table>

  <mat-menu #menu="matMenu">
    <button mat-menu-item (click)="openIncidentReportDialog()">
      <mat-icon>edit</mat-icon>
      <span>Validate or Update</span>
    </button>

    <button mat-menu-item (click)="handleDeleteIncident()">
      <mat-icon>delete</mat-icon>
      <span>Discard</span>
    </button>
  </mat-menu>
</div>